install.packages("ggplot2")
install.packages("data.table")
install.packages("dplyr")
install.packages("caret")
install.packages("lattice")
library("lattice", lib.loc="~/R/win-library/3.3")
library("ggplot2", lib.loc="~/R/win-library/3.3")
detach("package:ggplot2", unload=TRUE)
detach("package:lattice", unload=TRUE)
install.packages("stringr")
install.packages("data.table")
install.packages("zoo")
install.packages("data.table")
remove(list = ls())
# Poker and roulette winnings from Monday to Friday:
poker_vector <- c(140, -50, 20, -120, 240)
roulette_vector <- c(-24, -50, 100, -350, 10)
days_vector <- c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")
names(poker_vector) <- days_vector
names(roulette_vector) <- days_vector
# Which days did you make money on roulette?
selection_vector <- roulette_vector > 0
roulette_winning_days <- roulette_vector[selection_vector]
total_win_roulette <- sum(roulette_winning_days)
# Which days did you make money on poker?
selection_vector <- poker_vector > 0
poker_winning_days <- poker_vector[selection_vector]
total_win_poker <- sum(poker_winning_days)
#Print results
roulette_winning_days
total_win_roulette
poker_winning_days
total_win_poker
getwd()
rm(list = ls())
install.packages("installr")
library(installr)
updateR()
rm(list = ls())
rm(list = ls())
rm(list = ls())
version
version()
rversion)
rversion()
highlyCorrelated <- caret::findCorrelation(correlationMatrix, cutoff = 0.3)
library(caret)
library(ggplot2)
library(dummies)
#Importing dataset
df <- read.csv("HR_data.csv", header = TRUE)
#Renaming columns and cleaning the dataset
colnames(df)[colnames(df) == "sales"] <- "department"
#Creating factors, sampling and creating dummy variables
df$department <- as.factor(df$department)
df$salary <- as.factor(df$salary)
set.seed(123457)
train_index <- caret::createDataPartition(df$department, p = 0.7, list = FALSE)
df.train <- df[train_index,]
df.test <- df[-train_index,]
dum.colnames <- c("department", "salary")
df.train <- dummy.data.frame(data = df.train, names = dum.colnames, drop = TRUE, sep = "_")
df.test <- dummy.data.frame(data = df.test, names = dum.colnames, drop = TRUE, sep = "_")
#Feature selection
correlationMatrix <- cor(df.train)
highlyCorrelated <- caret::findCorrelation(correlationMatrix, cutoff = 0.3, verbose = TRUE)
rm(list = ls())
library(caret)
library(ggplot2)
library(dummies)
library(pROC)
library(randomForest)
#Importing dataset
df <- read.csv("HR_data.csv", header = TRUE)
#Renaming columns and cleaning the dataset
colnames(df)[colnames(df) == "sales"] <- "department"
#Creating factors and partitions(based on department)
df$department <- as.factor(df$department)
df$salary <- as.factor(df$salary)
df$left <- as.factor(df$left)
set.seed(123457)
install.packages("klaR")
setwd("~/GitHub/Employee-attrition-prediction")
library(caret)
library(ggplot2)
library(dummies)
library(pROC)
library(randomForest)
library(data.table)
library(dplyr)
#Importing dataset
df <- read.csv("HR_data.csv", header = TRUE)
#Renaming columns and cleaning the dataset
colnames(df)[colnames(df) == "sales"] <- "department"
#Creating factors and partitions
df$department <- as.factor(df$department)
df$salary <- as.factor(df$salary)
df$left <- as.factor(df$left)
#k-modes clustering
drop.cols <- c("left")
df.km <- select(df, -one_of(drop.cols))
library(klaR)
library(caret)
library(ggplot2)
library(dummies)
library(pROC)
library(randomForest)
library(data.table)
library(dplyr)
library(klaR)
#Importing dataset
df <- read.csv("HR_data.csv", header = TRUE)
#Renaming columns and cleaning the dataset
colnames(df)[colnames(df) == "sales"] <- "department"
#Creating factors and partitions
df$department <- as.factor(df$department)
df$salary <- as.factor(df$salary)
df$left <- as.factor(df$left)
#k-modes clustering
drop.cols <- c("left")
dummy.cols <- c("department", "salary")
df.km <- select(df, -one_of(drop.cols))
df.km <- select(df, -one_of(drop.cols))
#k-modes clustering
drop.cols <- c("left")
dummy.cols <- c("department", "salary")
df.km <- select(df, -one_of(drop.cols))
df.km <- dummy.data.frame(df.km, name = dummy.cols, sep = "_")
rm(list = ls())
library(caret)
library(ggplot2)
library(dummies)
library(pROC)
library(randomForest)
library(data.table)
library(dplyr)
library(klaR)
#Importing dataset
df <- read.csv("HR_data.csv", header = TRUE)
#Renaming columns and cleaning the dataset
colnames(df)[colnames(df) == "sales"] <- "department"
#Creating factors and partitions
df$department <- as.factor(df$department)
df$salary <- as.factor(df$salary)
df$left <- as.factor(df$left)
#k-modes clustering
drop.cols <- c("left")
dummy.cols <- c("department", "salary")
df.km <- select(df, -one_of(drop.cols))
df.km <- dummy.data.frame(df.km, name = dummy.cols, sep = "_")
df.km <- dummy.data.frame(df, name = dummy.cols, sep = "_")
colnames(df)
df.km
df.km[, -drop.cols]
rm(list = ls())
library(caret)
library(ggplot2)
library(dummies)
library(pROC)
library(randomForest)
library(data.table)
library(dplyr)
library(klaR)
#Importing dataset
df <- read.csv("HR_data.csv", header = TRUE)
#Renaming columns and cleaning the dataset
colnames(df)[colnames(df) == "sales"] <- "department"
#Creating factors and partitions
df$department <- as.factor(df$department)
df$salary <- as.factor(df$salary)
df$left <- as.factor(df$left)
#k-modes clustering
drop.cols <- c("left")
dummy.cols <- c("department", "salary")
df.km <- select(df, -one_of(drop.cols))
#k-modes clustering
drop.cols <- "left"
dummy.cols <- c("department", "salary")
df.km <- select(df, -one_of(drop.cols))
df.km <- select(df,-one_of(drop.cols))
#k-modes clustering
drop.cols <- c("left")
dummy.cols <- c("department", "salary")
df.km <- dummy.data.frame(df, name = dummy.cols, sep = "_")
fit.kmodes <- kmodes(df.km[,-], modes = 5, iter.max = 10)
fit.kmodes <- kmodes(df.km, modes = 5, iter.max = 10)
View(df.km)
fit.kmodes$size
fit.kmodes$modes
df.km$cluster <- fit.kmodes$cluster
View(df.km)
results <- data.frame()
colnames(results) <- c("cluster", "left")
results <- data.frame(cluster = 1:5, left)
results <- data.frame(cluster = 1:5, "left")
View(results)
results <- data.frame(cluster = 1:5, 1)
View(results)
colnames(results) <- c("Cluster", "Left")
View(results)
for (index in 1:5) {
left.cluster[index, 2] <- sum(df.km$cluster == index & df.km$left == 1)
}
for (index in 1:5) {
results[index, 2] <- sum(df.km$cluster == index & df.km$left == 1)
}
results <- data.frame(cluster = 1:5, 1, 1, 1)
colnames(results) <- c("Cluster", "Left", "Not Left", "Total")
fit.kmodes$size
results <- data.frame(cluster = 1:5, 1, 1, 1, 1)
colnames(results) <- c("Cluster", "Left", "Not Left", "Total", "Percentage Left")
for (index in 1:5) {
results[index, 2] <- sum(df.km$cluster == index & df.km$left == 1)
results[index, 3] <- sum(df.km$cluster == index & df.km$left == 0)
results[index, 4] <- results[index, 2] + results[index, 3]
results[index, 5] <- (results[index, 2] * 100) / results[index, 4]
}
View(df.km)
fit.kmodes <- kmodes(df.km[, -7], modes = 5, iter.max = 10)
df.km$cluster <- fit.kmodes$cluster
results <- data.frame(cluster = 1:5, 1, 1, 1, 1)
colnames(results) <- c("Cluster", "Left", "Not Left", "Total", "Percentage Left")
for (index in 1:5) {
results[index, 2] <- sum(df.km$cluster == index & df.km$left == 1)
results[index, 3] <- sum(df.km$cluster == index & df.km$left == 0)
results[index, 4] <- results[index, 2] + results[index, 3]
results[index, 5] <- (results[index, 2] * 100) / results[index, 4]
}
View(df.km)
ggplot(data = results, mapping = aes(x = results$Cluster, y = results$`Percentage Left`)) + xlab("Cluster") +
ylab("Percentage") +  geom_col()
